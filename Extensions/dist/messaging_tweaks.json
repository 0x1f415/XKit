{"id":"messaging_tweaks","script":"//* TITLE Messaging Tweaks **//\n//* VERSION 1.0.1 **//\n//* DESCRIPTION Helpful tweaks for Tumblr IM **//\n//* DETAILS This adds a few helpful tweaks to the Tumblr IM, for example minimising the chat, hiding the IM icon or changing the looks of the chat window. **//\n//* DEVELOPER New-XKit **//\n//* FRAME false **//\n//* BETA false **//\n\nXKit.extensions.messaging_tweaks = new Object({\n\n\trunning: false,\n\n\tobserver: null,\n\tchat_window_observer: null,\n\tlast_chat_title: \"\",\n\t\n\tpreferences: {\n\t\t\n\t\t\"sep0\": {\n\t\t\ttext: \"Messaging Popout & Button Tweaks\",\n\t\t\ttype: \"separator\",\n\t\t},\n\t\t\"reveal_true_face\": {\n\t\t\ttext: \"Tumbley the Tumblr\",\n\t\t\tdefault: false,\n\t\t\tvalue: false\n\t\t},\n\t\t\"hide_chat_bubble\": {\n\t\t\ttext: \"Hide the chat bubble completely\",\n\t\t\tdefault: false,\n\t\t\tvalue: false\n\t\t},\n\t\t\n\t\t\"sep1\": {\n\t\t\ttext: \"Chatbox Tweaks\",\n\t\t\ttype: \"separator\",\n\t\t},\n\t\t\"move_self_to_right\": {\n\t\t\ttext: \"Move your own messages to the right\",\n\t\t\tdefault: true,\n\t\t\tvalue: true\n\t\t},\n\t\t\"allow_minimising\": {\n\t\t\ttext: \"Allow minimising a chat by clicking on the title\",\n\t\t\tdefault: true,\n\t\t\tvalue: true\n\t\t},\n\t\t\n\t\t\"sep2\": {\n\t\t\ttext: \"CSS Tweaks\",\n\t\t\ttype: \"separator\"\n\t\t},\n\t\t\"my_chat_bubble_background\": {\n\t\t\ttext: \"Background for my chat bubbles\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"rgba(0,0,0,.05)\",\n\t\t\tvalue: \"rgba(0,0,0,.05)\"\n\t\t},\n\t\t\"other_chat_bubble_background\": {\n\t\t\ttext: \"Background for other people's chat bubbles\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"rgba(0,0,0,.1)\",\n\t\t\tvalue: \"rgba(0,0,0,.1)\"\n\t\t},\n\t\t\"background_override\": {\n\t\t\ttext: \"Change chat background color\",\n\t\t\ttype: \"text\",\n\t\t\tdefault: \"\",\n\t\t\tvalue: \"\"\n\t\t}\n\t\t\n\t},\n\t\n\tget_current_chat_user: function() {\n\t\tif($(\".title\").text().indexOf(\"+\") !== -1) {\n\t\t\treturn $($(\".title\").find(\"a\").get(0)).data(\"js-tumblelog-name\");\n\t\t} else {\n\t\t\treturn XKit.tools.get_current_blog();\n\t\t}\n\t},\n\t\n\tdo_messages: function() {\n\t\tXKit.extensions.messaging_tweaks.observer.disconnect();\n\t\tvar icons = $(\".messaging-conversation-popovers .avatar:not(.xkit-my_messaging_icon, .xkit-others_messaging_icon)\");\n\t\ticons.each(function() {\n\t\t\tif($(this).attr(\"data-js-tumblelog-name\") === XKit.extensions.messaging_tweaks.get_current_chat_user()) {\n\t\t\t\t$(this).addClass(\"xkit-my_messaging_icon\");\n\t\t\t\t$(this).parents(\".conversation-message\").addClass(\"xkit-my_messaging_message\");\n\t\t\t} else {\n\t\t\t\t$(this).addClass(\"xkit-others_messaging_icon\");\n\t\t\t\t$(this).parents(\".conversation-message\").addClass(\"xkit-others_messaging_message\");\n\t\t\t}\n\t\t});\n\t\tif(XKit.extensions.messaging_tweaks.preferences.move_self_to_right.value) {\n\t\t\t$(\".xkit-my_messaging_icon\").each(function() {\n\t\t\t\t$(this).parent().append($(this));\n\t\t\t});\n\t\t}\n\t\t\n\t\tif (XKit.extensions.messaging_tweaks.preferences.allow_minimising.value) {\n\t\t\tif(XKit.extensions.messaging_tweaks.last_chat_title !== $(\".messaging-conversation-popovers .title\").text()) {\n\t\t\t\tXKit.extensions.messaging_tweaks.last_chat_title = $(\".messaging-conversation-popovers .title\").text();\n\t\t\t\t$(\".conversation-header-main\").on(\"click.minimise_header\", function(e) {\n\t\t\t\t\tif (e.target !== this) { return; }\n\t\t\t\t\tif (!$(this).hasClass(\"minimised\")) {\n\t\t\t\t\t\t$(\".messaging-conversation-popovers\").animate({bottom: \"-404px\"});\n\t\t\t\t\t\t$(this).addClass(\"minimised\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(\".messaging-conversation-popovers\").animate({bottom: \"0px\"});\n\t\t\t\t\t\t$(this).removeClass(\"minimised\");\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t\n\t\tif ($(\".conversation-main\").get(0) !== null && typeof($(\".conversation-main\").get(0)) !== \"undefined\") {\n\t\t\tXKit.extensions.messaging_tweaks.observer.observe($(\".conversation-main\").get(0), {subtree: true, childList: true});\n\t\t}\n\t},\n\t\n\thook_chat_window: function() {\n\t\tXKit.extensions.messaging_tweaks.observer.observe($(\".conversation-main\").get(0), {subtree: true, childList: true});\n\t},\n\t\n\trun: function() {\n\t\tXKit.extensions.messaging_tweaks.observer = new MutationObserver(XKit.extensions.messaging_tweaks.do_messages);\n\t\tXKit.extensions.messaging_tweaks.chat_window_observer = new MutationObserver(function(mutations, observer) {\n\t\t\tmutations.forEach(function (mutation) {\n\t\t\t\tvar i, node;\n\t\t\t\t// Check if Chat Window has been added\n\t\t\t\tif (mutation.addedNodes.length) {\n\t\t\t\t\tfor (i = 0; i < mutation.addedNodes.length; i++) {\n\t\t\t\t\t\tnode = $(mutation.addedNodes[i]);\n\t\t\t\t\t\tif(node.hasClass(\"messaging-conversation-popovers\")) {\n\t\t\t\t\t\t\tXKit.extensions.messaging_tweaks.hook_chat_window();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t// Check if chat window has been removed\n\t\t\t\t} else if (mutation.removedNodes.length) {\n\t\t\t\t\tfor (i = 0; i < mutation.removedNodes.length; i++) {\n\t\t\t\t\t\tnode = $(mutation.removedNodes[i]);\n\t\t\t\t\t\tif(node.hasClass(\"messaging-conversation-popovers\")) {\n\t\t\t\t\t\t\tXKit.extensions.messaging_tweaks.observer.disconnect();\n\t\t\t\t\t\t\tXKit.extensions.messaging_tweaks.last_chat_title = \"\";\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tXKit.extensions.messaging_tweaks.chat_window_observer.observe(document.body, {\n\t\t\tchildList: true,\n\t\t\tsubtree: true,\n\t\t\tattributes: false,\n\t\t\tcharacterData: false\n\t\t});\n\t\tXKit.tools.init_css(\"messaging_tweaks\");\n\t\tif(XKit.extensions.messaging_tweaks.preferences.reveal_true_face.value) {\n\t\t\t$(\".tab.iconic.tab_messaging .tab_anchor\").addClass(\"true-icon\");\n\t\t}\n\t\tif(XKit.extensions.messaging_tweaks.preferences.hide_chat_bubble.value) {\n\t\t\t$(\".tab.iconic.tab_messaging\").hide();\n\t\t}\n\t\tif(XKit.extensions.messaging_tweaks.preferences.background_override.value !== \"\") {\n\t\t\tXKit.tools.add_css(\".conversation-main { background-color: \" + XKit.extensions.messaging_tweaks.preferences.background_override.value + \" !important; }\", \"messaging_tweaks\");\n\t\t}\n\t\tif(XKit.extensions.messaging_tweaks.preferences.move_self_to_right.value) {\n\t\t\tXKit.tools.add_css(\".xkit-my_messaging_icon { position: absolute; right: 0px; margin-right: 0px !important; }\", \"messaging_tweaks\");\n\t\t\tXKit.tools.add_css(\".xkit-my_messaging_message .message-bubble { margin-left: 0px !important; margin-right: 40px; text-align: right;}\", \"messaging_tweaks\");\n\t\t\tXKit.tools.add_css(\".xkit-my_messaging_message .message-container { justify-content: flex-end !important; }\", \"messaging_tweaks\");\n\t\t\tXKit.tools.add_css(\".xkit-my_messaging_message .message-bubble-header { justify-content: flex-end !important; }\", \"messaging_tweaks\");\n\t\t}\n\t\t\n\t\tXKit.tools.add_css(\".messaging-conversation .xkit-others_messaging_message .conversation-message-text .message-bubble { background-color: \" + XKit.extensions.messaging_tweaks.preferences.other_chat_bubble_background.value + \" !important; }\", \"messaging_tweaks\");\n\t\tXKit.tools.add_css(\".messaging-conversation .xkit-my_messaging_message .conversation-message-text .message-bubble { background-color: \" + XKit.extensions.messaging_tweaks.preferences.my_chat_bubble_background.value + \" !important; }\", \"messaging_tweaks\");\n\t\t\n\t\t// There's either 1 or no messaging-conversation-popovers on extension start\n\t\t$(\".messaging-conversation-popovers\").each(function() {\n\t\t\tXKit.extensions.messaging_tweaks.hook_chat_window();\n\t\t\tXKit.extensions.messaging_tweaks.do_messages();\n\t\t});\n\t\t\n\t\tthis.running = true;\n\t},\n\n\tdestroy: function() {\n\t\tXKit.extensions.messaging_tweaks.observer.disconnect();\n\t\tXKit.extensions.messaging_tweaks.chat_window_observer.disconnect();\n\t\tXKit.extensions.messaging_tweaks.last_chat_title = \"\";\n\t\tif(!XKit.extensions.messaging_tweaks.preferences.move_self_to_right.value) {\n\t\t\t$(\".xkit-my_messaging_icon\").each(function() {\n\t\t\t\t$(this).parent().prepend($(this));\n\t\t\t});\n\t\t}\n\t\t$(\".true-icon\").removeClass(\"true-icon\");\n\t\t$(\".tab.iconic.tab_messaging\").show();\n\t\t$(\".xkit-others_messaging_message\").removeClass(\"xkit-others_messaging_message\");\n\t\t$(\".xkit-others_messaging_icon\").removeClass(\"xkit-others_messaging_icon\");\n\t\t$(\".xkit-my_messaging_message\").removeClass(\"xkit-my_messaging_message\");\n\t\t$(\".xkit-my_messaging_icon\").removeClass(\"xkit-my_messaging_icon\");\n\t\tXKit.tools.remove_css(\"messaging_tweaks\");\n\t\tif ($(\".conversation-header-main\").hasClass(\"minimised\")) {\n\t\t\t$(\".messaging-conversation-popovers\").animate({bottom: \"0px\"});\n\t\t\t$(\".conversation-header-main\").removeClass(\"minimised\");\n\t\t}\n\t\t$(\".conversation-header-main\").off(\"click.minimise_header\");\n\t\tthis.running = false;\n\t}\n\n});\n","file":"found","server":"up","errors":false,"icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDE0IDc5LjE1Njc5NywgMjAxNC8wOC8yMC0wOTo1MzowMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkVBMUMyMUNGODhBMDExRTVBNUZDRDk4QzM5QjhFQjExIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkVBMUMyMUQwODhBMDExRTVBNUZDRDk4QzM5QjhFQjExIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RUExQzIxQ0Q4OEEwMTFFNUE1RkNEOThDMzlCOEVCMTEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RUExQzIxQ0U4OEEwMTFFNUE1RkNEOThDMzlCOEVCMTEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7Yc8K3AAAJ6UlEQVR42tRa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\n","css":".tab.iconic.tab_messaging .true-icon {\n\tbackground: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAVCAYAAABCIB6VAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACxSURBVEhLrZNRDsMwCEN7/0tnwGLmAaHplidZsTD4L9cYo9Md1Y2pHIqekjrSQPQP3sOFKqaaRZZ3CMrwbbdeeODFFTznvXjD3olLDLJqp8uMGCwXN/i6jSUIWR3LfTcTDuF3pLD/mElc5FepPL+e8yLAAjLeqTx2OcsDgWfwnRT2RhoIPHvywhtpMMEcWfdCzPJLK5x1qmiLf8X6Thd738li7jpWzD2mNAi6o7oRjesFZ0tq6opXmBsAAAAASUVORK5CYII=') no-repeat !important;\n\tmargin-left: -6px;\n\tmargin-right: -15px;\n\twidth: 46px;\n\tbackground-size: 27px !important;\n\tbackground-attachment: fixed;\n\tbackground-position: center !important;\n}\n\n.tab_bar .tab_messaging .true-icon:before {\n\tcontent: \"\" !important;\n}\n","title":"Messaging Tweaks","description":"Helpful tweaks for Tumblr IM","developer":"New-XKit","version":"1.0.1","details":"This adds a few helpful tweaks to the Tumblr IM, for example minimising the chat, hiding the IM icon or changing the looks of the chat window.","frame":"false","beta":"false","slow":"false"}